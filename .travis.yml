language: java

sudo: false

cache:
  directories:
    - '$HOME/.m2'
    - '$HOME/.jabba/jdk'

addons:
  apt:
    packages:
    - jq
    - curl
    - wget

install:
  # install jabba, if not existent
  - bash ./install-jabba.sh
  - . $HOME/.jabba/jabba.sh
  # install jdk if not installed
  - bash ./install-jdk.sh
  - . $HOME/.jabba/jabba.sh && jabba use adopt-openj9@1.11.0-2
  - export JAVA_HOME="$(. $HOME/.jabba/jabba.sh && jabba which adopt-openj9@1.11.0-2)"
  # install code cov jar
  - bash ./install-codecov.sh

# mvn will be run at this point

after_success:
  - bash <(java -jar ~/codacy-coverage-reporter-assembly-latest.jar report -l Java -r jacoco.xml --projectToken "${CODACY_PROJECT_TOKEN}")
